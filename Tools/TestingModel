import pandas as pd
from pandas import DataFrame



Super=['SuperpopulationChrAll.PC20SVMResults',  'SuperpopulationChrAll.PC20RandomForestResults',  'SuperpopulationChrAll.PC20NeuralNetworkResults']



for s in Super:
    check=pd.read_csv("check",sep="\t")
    ids=check[['BioProject ID']].drop_duplicates()
    ids=ids['BioProject ID'].tolist()
        
    results=pd.read_csv(s,sep="\t")
    results=results.rename(columns = {'ID':'run_accession'})
        
        
    test=pd.merge(results,check,on=['run_accession'])
        
        
        
    rlist=[]
    sample_size=[]
    for i in ids:
       rlist.append(len(test[(test['BioProject ID'] == i) & ((test['Superpopulation'] == test['Eth1']) | (test['Superpopulation'] == test['Eth2']))]) / len(test[test['BioProject ID'] == i])*100)
       sample_size.append(len(test[test['BioProject ID'] == i]))
        
        
        
    
    ids=check[['BioProject ID']].drop_duplicates()
    ids=ids.reset_index(drop=True)
    sample_size=DataFrame(sample_size,columns=['Sample Size'])
    
    
    if s.endswith("NeuralNetworkResults"):
        Results=DataFrame (rlist,columns=['Neural Network Accuracy'])
        NN=Results
    elif s.endswith("RandomForestResults"):
        Results=DataFrame (rlist,columns=['Random Forest Accuracy'])
        RF=Results
    else:
        Results=DataFrame (rlist,columns=['SVM Accuracy'])
        SVM=Results
    





RESULTS=pd.concat([ids,sample_size,RF,NN,SVM], axis=1)
RESULTS.to_csv('ChrAll_RBF_PC20_DPLT5',sep='\t',mode='w',index=False) 
