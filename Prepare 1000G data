import os 
from os import path

##Make list 1-22. Then add X. These will denote the Chrs
chr_num=[]
for x in range(23):
   if x !=0:
      chr_num.append(str(x))
chr_num.append("X")  
#chr_num.append("Y") 

#Make output directory
if path.exists("data") is not True:
        os.mkdir("data") 
 
os.chdir("data")
rule all: 
    input:
        "ChrAll.vcf.gz"
        
#Download vcf's for all chr in 1000G, filter indels, index.        
rule download1000G_filter:
    output:
        "ALL.chr{c}.shapeit2_integrated_snvindels_v2a_27022019.GRCh38.phased.vcf.gz"
    shell:
        """
        wget ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000_genomes_project/release/20190312_biallelic_SNV_and_INDEL/{output}
        bcftools view --types snps {output} --output-type z -o filtered.{output}
        tabix -fp vcf filtered.{output}
        """
#Concat call chr vcf's into one vcf, make interval list with final vcf. 
rule concat:
    input:
        expand("filtered.ALL.chr{c}.shapeit2_integrated_snvindels_v2a_27022019.GRCh38.phased.vcf.gz", c=chr_num)
    output:
        "ChrAll.vcf.gz"
    shell:        
        """
        bcftools concat --output-type z -o ChrAll.vcf.gz {input}  
        gatk VcfToIntervalList I={output} O=ChrAll.intervals
        tabix -fp vcf {output}
        """
